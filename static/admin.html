<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>æ–‡æ¡£ç®¡ç† - AIåŠ©æ‰‹</title> <style>*{margin:0;padding:0;box-sizing:border-box;}body{font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);min-height:100vh;padding:10px;}.container{max-width:1200px;margin:0 auto;background:white;border-radius:20px;box-shadow:0 20px 40px rgba(0,0,0,0.1);overflow:hidden;}.header{background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);color:white;padding:10px;text-align:center;}.header h1{font-size:2rem;margin-bottom:5px;}.header p{opacity:0.9;font-size:1rem;}.nav{display:flex;background:#f8f9fa;border-bottom:1px solid #e9ecef;}.nav-item{flex:1;padding:12px 20px;text-align:center;cursor:pointer;transition:all 0.3s ease;background:none;border:none;font-size:1rem;color:#495057;}.nav-item:hover{background:#e9ecef;}.nav-item.active{background:#667eea;color:white;}.content{padding:20px;}.section{display:none;}.section.active{display:block;}.form-group{margin-bottom:20px;}.form-group label{display:block;margin-bottom:8px;font-weight:600;color:#495057;}.form-control{width:100%;padding:12px 16px;border:2px solid #e9ecef;border-radius:10px;font-size:1rem;transition:border-color 0.3s ease;}.form-control:focus{outline:none;border-color:#667eea;}textarea.form-control{resize:vertical;min-height:150px;}.btn{padding:12px 24px;border:none;border-radius:10px;font-size:1rem;cursor:pointer;transition:all 0.3s ease;margin-right:10px;margin-bottom:10px;}.btn-primary{background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);color:white;}.btn-primary:hover{transform:translateY(-2px);box-shadow:0 10px 20px rgba(102, 126, 234, 0.3);}.btn-secondary{background:#6c757d;color:white;}.btn-danger{background:#dc3545;color:white;}.btn-danger:hover{background:#c82333;transform:translateY(-1px);}.btn-success{background:#28a745;color:white;}.document-list{margin-top:30px;display:grid;grid-template-columns:1fr 1fr;gap:15px;}.document-item{background:#f8f9fa;border-radius:10px;padding:20px;border-left:4px solid #667eea;display:flex;flex-direction:column;}@media (max-width:768px){.document-list{grid-template-columns:1fr;}}.document-item h3{color:#495057;margin-bottom:10px;}.document-item p{color:#6c757d;margin-bottom:15px;flex-grow:1;}.document-meta{font-size:0.9rem;color:#6c757d;margin-bottom:15px;}.document-actions{margin-top:auto;display:flex;flex-wrap:wrap;gap:8px;}.document-actions .btn{flex:1;min-width:80px;font-size:0.9rem;padding:8px 12px;}.alert{padding:15px;border-radius:10px;margin-bottom:20px;}.alert-success{background:#d4edda;color:#155724;border:1px solid #c3e6cb;}.alert-error{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb;}.file-upload{border:2px dashed #667eea;border-radius:10px;padding:40px;text-align:center;margin-bottom:20px;transition:all 0.3s ease;}.file-upload:hover{background:#f8f9ff;}.file-upload input[type="file"]{display:none;}.upload-text{color:#667eea;font-size:1.1rem;margin-bottom:10px;}.loading{display:none;text-align:center;padding:20px;}.spinner{border:3px solid #f3f3f3;border-top:3px solid #667eea;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:0 auto 15px;}@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}</style></head><body><div class="container"><div class="header"><div style="display: flex; justify-content: space-between; align-items: center;"><div><h1>ğŸ“š æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ</h1></div><div style="display: flex; align-items: center; gap: 15px;"><span id="userInfo" style="font-size: 0.9rem; opacity: 0.9;"></span><button onclick="logout()" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.5); color: white; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-size: 0.9rem;"> ğŸšª é€€å‡ºç™»å½• </button></div></div></div><div class="nav"><button class="nav-item active" onclick="showSection('documents')">ğŸ“„ æ–‡æ¡£ç®¡ç†</button><button class="nav-item" onclick="showSection('upload')">ğŸ“¤ ä¸Šä¼ æ–‡æ¡£</button><button class="nav-item" onclick="showSection('preamble')">âš™ï¸ Preambleé…ç½®</button><button class="nav-item" onclick="showSection('conversations')">ğŸ’¬ å¯¹è¯è®°å½•</button><button class="nav-item" onclick="showSection('users')">ğŸ‘¥ ç”¨æˆ·ç®¡ç†</button></div><div class="content"><div id="documents" class="section active"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;"><h2>ğŸ“„ æ–‡æ¡£åˆ—è¡¨</h2></div><div class="loading" id="documentsLoading"><div class="spinner"></div><p>æ­£åœ¨åŠ è½½æ–‡æ¡£...</p></div><div id="documentsList" class="document-list"></div><div id="pagination" class="pagination" style="display: none; margin-top: 20px; text-align: center;"><button id="prevPage" class="btn btn-secondary" disabled>â¬…ï¸ ä¸Šä¸€é¡µ</button><span id="pageInfo" style="margin: 0 15px; color: #6c757d;"></span><button id="nextPage" class="btn btn-secondary" disabled>ä¸‹ä¸€é¡µ â¡ï¸</button></div></div><div id="upload" class="section"><h2>ğŸ“¤ ä¸Šä¼ æ–‡æ¡£</h2><div class="file-upload" onclick="document.getElementById('fileInput').click()"><div class="upload-text">ğŸ¯ ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„</div><p style="color: #6c757d;">æ”¯æŒ .txt, .md, .json, .csv, .pdf, .docx, .xlsx ç­‰æ–‡æœ¬æ–‡ä»¶</p><input type="file" id="fileInput" accept=".txt,.md,.json,.csv,.pdf,.docx,.xlsx" onchange="handleFileSelect(event)"></div><h3 style="margin-top: 30px; margin-bottom: 15px;">âœï¸ æ‰‹åŠ¨åˆ›å»ºæ–‡æ¡£</h3><form id="createDocumentForm"><div class="form-group"><label for="documentFilename">æ–‡ä»¶åï¼š</label><input type="text" id="documentFilename" class="form-control" placeholder="ä¾‹å¦‚ï¼šexample.md" required></div><div class="form-group"><label for="documentContent">æ–‡æ¡£å†…å®¹ï¼š</label> <textarea id="documentContent" class="form-control" rows="10" 
                                placeholder="è¯·è¾“å…¥æ–‡æ¡£å†…å®¹..." required></textarea> </div><button type="submit" class="btn btn-primary">ğŸ“ åˆ›å»ºæ–‡æ¡£</button></form></div><div id="preamble" class="section"><h2>âš™ï¸ Preambleé…ç½®</h2><p style="margin-bottom: 20px; color: #6c757d;"> Preambleæ˜¯AIåŠ©æ‰‹çš„ç³»ç»Ÿæç¤ºè¯ï¼Œç”¨äºå®šä¹‰åŠ©æ‰‹çš„è¡Œä¸ºå’Œè§’è‰²ã€‚ </p><div class="loading" id="preambleLoading"><div class="spinner"></div><p>æ­£åœ¨åŠ è½½é…ç½®...</p></div><form id="preambleForm" style="display: none;"><div class="form-group"><label for="preambleContent">Preambleå†…å®¹ï¼š</label> <textarea id="preambleContent" class="form-control" rows="22" 
                                placeholder="è¯·è¾“å…¥AIåŠ©æ‰‹çš„ç³»ç»Ÿæç¤ºè¯..."></textarea> </div><button type="submit" class="btn btn-primary">ğŸ’¾ ä¿å­˜é…ç½®</button></form></div><div id="users" class="section"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;"><h2>ğŸ‘¥ ç”¨æˆ·ç®¡ç†</h2><button class="btn btn-primary" onclick="showCreateUserModal()" style="padding: 10px 20px;"> â• åˆ›å»ºç”¨æˆ· </button></div><div class="loading" id="usersLoading"><div class="spinner"></div><p>æ­£åœ¨åŠ è½½ç”¨æˆ·...</p></div><div id="usersList"></div></div><div id="conversations" class="section"><div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;"><h2 style="margin: 0; font-size: 1.25rem; line-height: 1.2;">ğŸ’¬ å¯¹è¯è®°å½•ç®¡ç†</h2><div style="display: flex; gap: 10px;"><input type="text" id="conversationSearch" class="form-control form-control-sm" placeholder="æœç´¢ç”¨æˆ·IDæˆ–å¯¹è¯ID..." style="width: 200px; height: 32px; padding: 0px 8px; font-size: 16px; border-radius: 6px;"><button class="btn btn-secondary" style="height: 32px; padding: 0px 18px;" onclick="searchConversations()">ğŸ” æœç´¢</button><button class="btn btn-primary" style="height: 32px; padding: 0px 18px;" onclick="loadConversations()">ğŸ”„ åˆ·æ–°</button><button class="btn btn-danger" style="height: 32px; padding: 0px 18px;" onclick="showCleanupDialog()">ğŸ—‘ï¸ æ¸…ç†æ—§è®°å½•</button></div></div><div id="conversationStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;"><div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center;"><h3 style="margin: 0; color: #667eea;">æ€»å¯¹è¯æ•°</h3><p id="totalConversations" style="margin: 5px 0; font-size: 1.5rem; font-weight: bold;">-</p></div><div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center;"><h3 style="margin: 0; color: #667eea;">æ´»è·ƒå¯¹è¯</h3><p id="activeConversations" style="margin: 5px 0; font-size: 1.5rem; font-weight: bold;">-</p></div><div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center;"><h3 style="margin: 0; color: #667eea;">æ€»æ¶ˆæ¯æ•°</h3><p id="totalMessages" style="margin: 5px 0; font-size: 1.5rem; font-weight: bold;">-</p></div><div style="background: #f8f9fa; padding: 15px; border-radius: 10px; text-align: center;"><h3 style="margin: 0; color: #667eea;">ä»Šæ—¥æ–°å¢</h3><p id="todayConversations" style="margin: 5px 0; font-size: 1.5rem; font-weight: bold;">-</p></div></div><div class="loading" id="conversationsLoading"><div class="spinner"></div><p>æ­£åœ¨åŠ è½½å¯¹è¯è®°å½•...</p></div><div id="conversationsList" style="display: grid; gap: 15px;"></div><div id="conversationPagination" class="pagination" style="display: none; margin-top: 20px; text-align: center;"><button id="conversationPrevPage" class="btn btn-secondary" disabled>â¬…ï¸ ä¸Šä¸€é¡µ</button><span id="conversationPageInfo" style="margin: 0 15px; color: #6c757d;"></span><button id="conversationNextPage" class="btn btn-secondary" disabled>ä¸‹ä¸€é¡µ â¡ï¸</button></div></div></div></div><div id="alertContainer" style="position: fixed; top: 20px; right: 20px; z-index: 1000;"></div> <script src="/static/js/admin.js"></script> <script src="/static/js/chatbot.js"></script> <script>const chatbot = new RigChat({apiBase: "", title: "AI Assistant",welcomeMessage: "ğŸ‘‹ æ‚¨å¥½ï¼Œæˆ‘æ˜¯AI Assistantï¼Œå¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ï¼",buttonIcon: "ai",theme: "dark",position: "right",placeholder: "è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..."});</script></body></html>